2025-04-08 12:48:53,652 - WARNING -  * Debugger is active!
2025-04-08 12:48:53,668 - INFO -  * Debugger PIN: 716-329-026
2025-04-08 12:48:55,534 - INFO - Request[POST]: https://api.sandbox.paypal.com/v1/oauth2/token
2025-04-08 12:48:56,351 - INFO - Response[200]: OK, Duration: 0.815819s.
2025-04-08 12:48:56,351 - INFO - PayPal-Request-Id: 1a460933-5b4c-49bd-84b8-cd78603efd0b
2025-04-08 12:48:56,364 - INFO - Request[POST]: https://api.sandbox.paypal.com/v1/payments/payment
2025-04-08 12:48:57,714 - INFO - Response[400]: Bad Request, Duration: 1.349735s.
2025-04-08 12:48:57,714 - ERROR - T·∫°o payment th·∫•t b·∫°i. Booking ID: 4, L·ªói: {'name': 'CURRENCY_NOT_ALLOWED', 'message': 'Currency is not supported', 'information_link': 'https://developer.paypal.com/docs/api/payments/v1/#error-CURRENCY_NOT_ALLOWED', 'debug_id': '75eb0a5d67536'}
2025-04-08 12:48:57,714 - INFO - 127.0.0.1 - - [08/Apr/2025 12:48:57] "[35m[1mGET /payment/4 HTTP/1.1[0m" 500 -
2025-04-08 12:51:30,726 - INFO -  * Detected change in 'C:\\Users\\Minh\\Documents\\GitHub\\doan2\\utils\\db_supabase.py', reloading
2025-04-08 12:51:31,554 - WARNING -  * Debugger is active!
2025-04-08 12:51:31,561 - INFO -  * Debugger PIN: 716-329-026
2025-04-08 12:51:38,962 - INFO -  * Detected change in 'C:\\Users\\Minh\\Documents\\GitHub\\doan2\\routes\\payment.py', reloading
2025-04-08 12:51:39,871 - WARNING -  * Debugger is active!
2025-04-08 12:51:39,879 - INFO -  * Debugger PIN: 716-329-026
2025-04-08 12:51:47,781 - INFO - HTTP Request: GET https://uaggzmqpvbtrinppmhrc.supabase.co/rest/v1/bookings?select=total_amount&id=eq.4 "HTTP/2 404 Not Found"
2025-04-08 12:51:47,782 - ERROR - L·ªói ngo·∫°i l·ªá khi t·∫°o thanh to√°n cho booking 4
Traceback (most recent call last):
  File "C:\Users\Minh\Documents\GitHub\doan2\routes\payment.py", line 27, in pay
    amount = get_booking_amount(booking_id)  # Gi·∫£ s·ª≠ tr·∫£ v·ªÅ float ho·∫∑c int
  File "C:\Users\Minh\Documents\GitHub\doan2\utils\db_supabase.py", line 45, in get_booking_amount
    response = supabase.table("bookings").select("total_amount").eq("id", booking_id).single().execute()
  File "C:\Users\Minh\Documents\GitHub\doan2\myenv\lib\site-packages\postgrest\_sync\request_builder.py", line 127, in execute
    raise APIError(r.json())
postgrest.exceptions.APIError: {'code': '42P01', 'details': None, 'hint': None, 'message': 'relation "public.bookings" does not exist'}
2025-04-08 12:51:47,788 - INFO - 127.0.0.1 - - [08/Apr/2025 12:51:47] "[35m[1mGET /payment/4 HTTP/1.1[0m" 500 -
2025-04-08 12:53:45,651 - INFO -  * Detected change in 'C:\\Users\\Minh\\Documents\\GitHub\\doan2\\utils\\db_supabase.py', reloading
2025-04-08 12:55:25,594 - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
2025-04-08 12:55:25,594 - INFO - [33mPress CTRL+C to quit[0m
2025-04-08 12:55:25,594 - INFO -  * Restarting with stat
2025-04-08 12:55:26,239 - WARNING -  * Debugger is active!
2025-04-08 12:55:26,245 - INFO -  * Debugger PIN: 716-329-026
2025-04-08 12:55:30,698 - INFO - 127.0.0.1 - - [08/Apr/2025 12:55:30] "GET / HTTP/1.1" 200 -
2025-04-08 12:55:37,969 - INFO - HTTP Request: GET https://uaggzmqpvbtrinppmhrc.supabase.co/rest/v1/phong?select=%2A&trangthai=eq.Tr%E1%BB%91ng "HTTP/2 200 OK"
2025-04-08 12:55:37,979 - INFO - 127.0.0.1 - - [08/Apr/2025 12:55:37] "GET /booking/dat-phong HTTP/1.1" 200 -
2025-04-08 12:55:50,959 - INFO - HTTP Request: GET https://uaggzmqpvbtrinppmhrc.supabase.co/rest/v1/phong?select=%2A&trangthai=eq.Tr%E1%BB%91ng "HTTP/2 200 OK"
2025-04-08 12:55:51,154 - INFO - HTTP Request: POST https://uaggzmqpvbtrinppmhrc.supabase.co/rest/v1/datphong "HTTP/2 201 Created"
2025-04-08 12:55:51,158 - INFO - 127.0.0.1 - - [08/Apr/2025 12:55:51] "[32mPOST /booking/dat-phong HTTP/1.1[0m" 302 -
2025-04-08 12:55:51,321 - INFO - HTTP Request: GET https://uaggzmqpvbtrinppmhrc.supabase.co/rest/v1/datphong?select=tong_tien&id=eq.5 "HTTP/2 400 Bad Request"
2025-04-08 12:55:51,328 - ERROR - L·ªói ngo·∫°i l·ªá khi t·∫°o thanh to√°n cho booking 5
Traceback (most recent call last):
  File "C:\Users\Minh\Documents\GitHub\doan2\routes\payment.py", line 28, in pay
    amount = get_booking_amount(booking_id)  # L·∫•y t·ªïng ti·ªÅn t·ª´ Supabase
  File "C:\Users\Minh\Documents\GitHub\doan2\utils\db_supabase.py", line 46, in get_booking_amount
    response = supabase.table("datphong").select("tong_tien").eq("id", booking_id).single().execute()
  File "C:\Users\Minh\Documents\GitHub\doan2\myenv\lib\site-packages\postgrest\_sync\request_builder.py", line 127, in execute
    raise APIError(r.json())
postgrest.exceptions.APIError: {'code': '42703', 'details': None, 'hint': 'Perhaps you meant to reference the column "datphong.tongtien".', 'message': 'column datphong.tong_tien does not exist'}
2025-04-08 12:55:51,332 - INFO - 127.0.0.1 - - [08/Apr/2025 12:55:51] "[35m[1mGET /payment/5 HTTP/1.1[0m" 500 -
2025-04-08 12:58:00,025 - INFO -  * Detected change in 'C:\\Users\\Minh\\Documents\\GitHub\\doan2\\utils\\db_supabase.py', reloading
2025-04-08 12:58:00,206 - INFO -  * Restarting with stat
2025-04-08 12:58:00,982 - WARNING -  * Debugger is active!
2025-04-08 12:58:00,989 - INFO -  * Debugger PIN: 716-329-026
2025-04-08 12:59:10,227 - INFO -  * Detected change in 'C:\\Users\\Minh\\Documents\\GitHub\\doan2\\utils\\db_supabase.py', reloading
2025-04-08 12:59:10,310 - INFO -  * Restarting with stat
2025-04-08 12:59:11,051 - WARNING -  * Debugger is active!
2025-04-08 12:59:11,058 - INFO -  * Debugger PIN: 716-329-026
2025-04-08 12:59:12,541 - INFO - HTTP Request: GET https://uaggzmqpvbtrinppmhrc.supabase.co/rest/v1/datphong?select=tongtien&madatphong=eq.5 "HTTP/2 200 OK"
2025-04-08 12:59:12,547 - ERROR - L·ªói ngo·∫°i l·ªá khi t·∫°o thanh to√°n cho booking 5
Traceback (most recent call last):
  File "C:\Users\Minh\Documents\GitHub\doan2\routes\payment.py", line 28, in pay
    amount = get_booking_amount(booking_id)  # L·∫•y t·ªïng ti·ªÅn t·ª´ Supabase
  File "C:\Users\Minh\Documents\GitHub\doan2\utils\db_supabase.py", line 50, in get_booking_amount
    return float(response.data['tongtien'])
TypeError: float() argument must be a string or a real number, not 'NoneType'
2025-04-08 12:59:12,548 - INFO - 127.0.0.1 - - [08/Apr/2025 12:59:12] "[35m[1mGET /payment/5 HTTP/1.1[0m" 500 -
2025-04-08 13:02:33,028 - INFO -  * Detected change in 'C:\\Users\\Minh\\Documents\\GitHub\\doan2\\utils\\db_supabase.py', reloading
2025-04-08 13:02:33,123 - INFO -  * Restarting with stat
2025-04-08 13:02:33,893 - WARNING -  * Debugger is active!
2025-04-08 13:02:33,909 - INFO -  * Debugger PIN: 716-329-026
2025-04-08 13:05:43,979 - INFO -  * Detected change in 'C:\\Users\\Minh\\Documents\\GitHub\\doan2\\utils\\db_supabase.py', reloading
2025-04-08 13:05:44,151 - INFO -  * Restarting with stat
2025-04-08 13:05:45,066 - WARNING -  * Debugger is active!
2025-04-08 13:05:45,078 - INFO -  * Debugger PIN: 716-329-026
2025-04-08 13:05:53,544 - INFO -  * Detected change in 'C:\\Users\\Minh\\Documents\\GitHub\\doan2\\routes\\booking.py', reloading
2025-04-08 13:05:53,657 - INFO -  * Restarting with stat
2025-04-08 13:05:54,331 - WARNING -  * Debugger is active!
2025-04-08 13:05:54,336 - INFO -  * Debugger PIN: 716-329-026
2025-04-08 13:06:13,367 - INFO -  * Detected change in 'C:\\Users\\Minh\\Documents\\GitHub\\doan2\\app.py', reloading
2025-04-08 13:06:13,485 - INFO -  * Restarting with stat
2025-04-08 13:06:14,150 - WARNING -  * Debugger is active!
2025-04-08 13:06:14,150 - INFO -  * Debugger PIN: 716-329-026
2025-04-08 13:06:17,254 - INFO - HTTP Request: GET https://uaggzmqpvbtrinppmhrc.supabase.co/rest/v1/datphong?select=tongtien&madatphong=eq.5 "HTTP/2 200 OK"
2025-04-08 13:06:17,260 - ERROR - L·ªói ngo·∫°i l·ªá khi t·∫°o thanh to√°n cho booking 5
Traceback (most recent call last):
  File "C:\Users\Minh\Documents\GitHub\doan2\routes\payment.py", line 28, in pay
    amount = get_booking_amount(booking_id)  # L·∫•y t·ªïng ti·ªÅn t·ª´ Supabase
  File "C:\Users\Minh\Documents\GitHub\doan2\utils\db_supabase.py", line 50, in get_booking_amount
    return float(response.data['tongtien'])
TypeError: float() argument must be a string or a real number, not 'NoneType'
2025-04-08 13:06:17,261 - INFO - 127.0.0.1 - - [08/Apr/2025 13:06:17] "[35m[1mGET /payment/5 HTTP/1.1[0m" 500 -
2025-04-08 13:06:18,379 - INFO - HTTP Request: GET https://uaggzmqpvbtrinppmhrc.supabase.co/rest/v1/phong?select=%2A&trangthai=eq.tr%E1%BB%91ng "HTTP/2 200 OK"
2025-04-08 13:06:18,379 - INFO - 127.0.0.1 - - [08/Apr/2025 13:06:18] "GET /booking/dat-phong HTTP/1.1" 200 -
2025-04-08 13:06:18,857 - INFO - 127.0.0.1 - - [08/Apr/2025 13:06:18] "GET / HTTP/1.1" 200 -
2025-04-08 13:06:20,947 - INFO - HTTP Request: GET https://uaggzmqpvbtrinppmhrc.supabase.co/rest/v1/phong?select=%2A&trangthai=eq.tr%E1%BB%91ng "HTTP/2 200 OK"
2025-04-08 13:06:20,964 - INFO - 127.0.0.1 - - [08/Apr/2025 13:06:20] "GET /booking/dat-phong HTTP/1.1" 200 -
2025-04-08 13:08:23,310 - INFO -  * Detected change in 'C:\\Users\\Minh\\Documents\\GitHub\\doan2\\utils\\db_supabase.py', reloading
2025-04-08 13:08:23,489 - INFO -  * Restarting with stat
2025-04-08 13:08:24,424 - WARNING -  * Debugger is active!
2025-04-08 13:08:24,424 - INFO -  * Debugger PIN: 716-329-026
2025-04-08 13:08:26,638 - INFO - HTTP Request: GET https://uaggzmqpvbtrinppmhrc.supabase.co/rest/v1/phong?select=%2A&trangthai=eq.tr%E1%BB%91ng "HTTP/2 200 OK"
2025-04-08 13:08:26,657 - INFO - 127.0.0.1 - - [08/Apr/2025 13:08:26] "GET /booking/dat-phong HTTP/1.1" 200 -
2025-04-08 13:08:29,421 - INFO - HTTP Request: GET https://uaggzmqpvbtrinppmhrc.supabase.co/rest/v1/phong?select=%2A&trangthai=eq.tr%E1%BB%91ng "HTTP/2 200 OK"
2025-04-08 13:08:29,424 - INFO - 127.0.0.1 - - [08/Apr/2025 13:08:29] "GET /booking/dat-phong HTTP/1.1" 200 -
2025-04-08 13:08:29,653 - INFO - HTTP Request: GET https://uaggzmqpvbtrinppmhrc.supabase.co/rest/v1/phong?select=%2A&trangthai=eq.tr%E1%BB%91ng "HTTP/2 200 OK"
2025-04-08 13:08:29,670 - INFO - 127.0.0.1 - - [08/Apr/2025 13:08:29] "GET /booking/dat-phong HTTP/1.1" 200 -
2025-04-08 13:09:22,667 - INFO -  * Detected change in 'C:\\Users\\Minh\\Documents\\GitHub\\doan2\\utils\\db_supabase.py', reloading
2025-04-08 13:09:22,848 - INFO -  * Restarting with stat
2025-04-08 13:09:23,550 - WARNING -  * Debugger is active!
2025-04-08 13:09:23,550 - INFO -  * Debugger PIN: 716-329-026
2025-04-08 13:09:25,235 - INFO - HTTP Request: GET https://uaggzmqpvbtrinppmhrc.supabase.co/rest/v1/phong?select=%2A&trangthai=eq.tr%E1%BB%91ng "HTTP/2 200 OK"
2025-04-08 13:09:25,252 - INFO - 127.0.0.1 - - [08/Apr/2025 13:09:25] "GET /booking/dat-phong HTTP/1.1" 200 -
2025-04-08 13:09:56,611 - INFO -  * Detected change in 'C:\\Users\\Minh\\Documents\\GitHub\\doan2\\utils\\db_supabase.py', reloading
2025-04-08 13:09:56,707 - INFO -  * Restarting with stat
2025-04-08 13:09:57,446 - WARNING -  * Debugger is active!
2025-04-08 13:09:57,451 - INFO -  * Debugger PIN: 716-329-026
2025-04-08 13:10:19,946 - INFO -  * Detected change in 'C:\\Users\\Minh\\Documents\\GitHub\\doan2\\utils\\db_supabase.py', reloading
2025-04-08 13:10:20,069 - INFO -  * Restarting with stat
2025-04-08 13:10:20,753 - WARNING -  * Debugger is active!
2025-04-08 13:10:20,755 - INFO -  * Debugger PIN: 716-329-026
2025-04-08 13:10:33,637 - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
2025-04-08 13:10:33,637 - INFO - [33mPress CTRL+C to quit[0m
2025-04-08 13:10:33,640 - INFO -  * Restarting with stat
2025-04-08 13:10:34,432 - WARNING -  * Debugger is active!
2025-04-08 13:10:34,437 - INFO -  * Debugger PIN: 716-329-026
2025-04-08 13:10:36,929 - INFO - 127.0.0.1 - - [08/Apr/2025 13:10:36] "GET / HTTP/1.1" 200 -
2025-04-08 13:10:37,019 - INFO - 127.0.0.1 - - [08/Apr/2025 13:10:37] "[33mGET /favicon.ico HTTP/1.1[0m" 404 -
2025-04-08 13:10:38,840 - INFO - 127.0.0.1 - - [08/Apr/2025 13:10:38] "GET /auth/login HTTP/1.1" 200 -
2025-04-08 13:10:38,868 - INFO - 127.0.0.1 - - [08/Apr/2025 13:10:38] "[33mGET /static/css/style.css HTTP/1.1[0m" 404 -
2025-04-08 13:10:40,794 - INFO - HTTP Request: GET https://uaggzmqpvbtrinppmhrc.supabase.co/rest/v1/khachhang?select=%2A&email=eq.minh1%40gmail.com "HTTP/2 200 OK"
2025-04-08 13:10:40,796 - INFO - 127.0.0.1 - - [08/Apr/2025 13:10:40] "POST /auth/login HTTP/1.1" 200 -
2025-04-08 13:10:40,829 - INFO - 127.0.0.1 - - [08/Apr/2025 13:10:40] "[33mGET /static/css/style.css HTTP/1.1[0m" 404 -
2025-04-08 13:10:42,676 - INFO - HTTP Request: GET https://uaggzmqpvbtrinppmhrc.supabase.co/rest/v1/khachhang?select=%2A&email=eq.minh1%40gmail.com "HTTP/2 200 OK"
2025-04-08 13:10:42,698 - INFO - 127.0.0.1 - - [08/Apr/2025 13:10:42] "[32mPOST /auth/login HTTP/1.1[0m" 302 -
2025-04-08 13:10:42,707 - INFO - 127.0.0.1 - - [08/Apr/2025 13:10:42] "GET / HTTP/1.1" 200 -
2025-04-08 13:10:44,658 - INFO - HTTP Request: GET https://uaggzmqpvbtrinppmhrc.supabase.co/rest/v1/phong?select=%2A&trangthai=eq.tr%E1%BB%91ng "HTTP/2 200 OK"
2025-04-08 13:10:44,675 - INFO - 127.0.0.1 - - [08/Apr/2025 13:10:44] "GET /booking/dat-phong HTTP/1.1" 200 -
2025-04-08 13:12:12,255 - INFO -  * Detected change in 'C:\\Users\\Minh\\Documents\\GitHub\\doan2\\utils\\db_supabase.py', reloading
2025-04-08 13:12:12,398 - INFO -  * Restarting with stat
2025-04-08 13:12:13,180 - WARNING -  * Debugger is active!
2025-04-08 13:12:13,196 - INFO -  * Debugger PIN: 716-329-026
2025-04-08 13:12:15,213 - INFO - HTTP Request: GET https://uaggzmqpvbtrinppmhrc.supabase.co/rest/v1/phong?select=%2A&trangthai=eq.Tr%E1%BB%91ng "HTTP/2 200 OK"
2025-04-08 13:12:15,224 - INFO - 127.0.0.1 - - [08/Apr/2025 13:12:15] "GET /booking/dat-phong HTTP/1.1" 200 -
2025-04-08 13:12:28,233 - INFO - HTTP Request: GET https://uaggzmqpvbtrinppmhrc.supabase.co/rest/v1/phong?select=%2A&trangthai=eq.Tr%E1%BB%91ng "HTTP/2 200 OK"
2025-04-08 13:12:28,403 - INFO - HTTP Request: POST https://uaggzmqpvbtrinppmhrc.supabase.co/rest/v1/datphong "HTTP/2 201 Created"
2025-04-08 13:12:28,409 - INFO - 127.0.0.1 - - [08/Apr/2025 13:12:28] "[32mPOST /booking/dat-phong HTTP/1.1[0m" 302 -
2025-04-08 13:12:28,506 - INFO - HTTP Request: GET https://uaggzmqpvbtrinppmhrc.supabase.co/rest/v1/datphong?select=tongtien&madatphong=eq.6 "HTTP/2 200 OK"
2025-04-08 13:12:28,506 - ERROR - L·ªói ngo·∫°i l·ªá khi t·∫°o thanh to√°n cho booking 6
Traceback (most recent call last):
  File "C:\Users\Minh\Documents\GitHub\doan2\routes\payment.py", line 28, in pay
    amount = get_booking_amount(booking_id)  # L·∫•y t·ªïng ti·ªÅn t·ª´ Supabase
  File "C:\Users\Minh\Documents\GitHub\doan2\utils\db_supabase.py", line 50, in get_booking_amount
    return float(response.data['tongtien'])
TypeError: float() argument must be a string or a real number, not 'NoneType'
2025-04-08 13:12:28,506 - INFO - 127.0.0.1 - - [08/Apr/2025 13:12:28] "[35m[1mGET /payment/6 HTTP/1.1[0m" 500 -
2025-04-08 13:14:36,779 - INFO -  * Detected change in 'C:\\Users\\Minh\\Documents\\GitHub\\doan2\\routes\\booking.py', reloading
2025-04-08 13:14:36,895 - INFO -  * Restarting with stat
2025-04-08 13:14:37,548 - WARNING -  * Debugger is active!
2025-04-08 13:14:37,565 - INFO -  * Debugger PIN: 716-329-026
2025-04-08 13:14:44,272 - INFO - HTTP Request: GET https://uaggzmqpvbtrinppmhrc.supabase.co/rest/v1/phong?select=%2A&trangthai=eq.Tr%E1%BB%91ng "HTTP/2 200 OK"
2025-04-08 13:14:44,428 - INFO - HTTP Request: POST https://uaggzmqpvbtrinppmhrc.supabase.co/rest/v1/datphong "HTTP/2 201 Created"
2025-04-08 13:14:44,428 - INFO - 127.0.0.1 - - [08/Apr/2025 13:14:44] "[32mPOST /booking/dat-phong HTTP/1.1[0m" 302 -
2025-04-08 13:14:44,611 - INFO - HTTP Request: GET https://uaggzmqpvbtrinppmhrc.supabase.co/rest/v1/datphong?select=tongtien&madatphong=eq.7 "HTTP/2 200 OK"
2025-04-08 13:14:44,615 - INFO - Request[POST]: https://api.sandbox.paypal.com/v1/oauth2/token
2025-04-08 13:14:45,925 - INFO - Response[200]: OK, Duration: 1.310345s.
2025-04-08 13:14:45,925 - INFO - PayPal-Request-Id: 7ccf5d0d-c735-4233-bcf1-1924e180e021
2025-04-08 13:14:45,925 - INFO - Request[POST]: https://api.sandbox.paypal.com/v1/payments/payment
2025-04-08 13:14:46,920 - INFO - Response[201]: Created, Duration: 0.994041s.
2025-04-08 13:14:46,921 - INFO - T·∫°o payment th√†nh c√¥ng. Booking ID: 7, Payment ID: PAYID-M72L5VQ6Y06666473223511A
2025-04-08 13:14:46,922 - INFO - 127.0.0.1 - - [08/Apr/2025 13:14:46] "[32mGET /payment/7 HTTP/1.1[0m" 302 -
2025-04-08 13:14:59,474 - INFO - 127.0.0.1 - - [08/Apr/2025 13:14:59] "[33mGET /success?paymentId=PAYID-M72L5VQ6Y06666473223511A&token=EC-2JY51007VA992760F&PayerID=EZEAHEJEKML38 HTTP/1.1[0m" 404 -
2025-04-08 13:14:59,593 - INFO - 127.0.0.1 - - [08/Apr/2025 13:14:59] "[33mGET /favicon.ico HTTP/1.1[0m" 404 -
2025-04-08 13:15:14,607 - INFO - 127.0.0.1 - - [08/Apr/2025 13:15:14] "[33mGET /success?paymentId=PAYID-M72L5VQ6Y06666473223511A&token=EC-2JY51007VA992760F&PayerID=EZEAHEJEKML38 HTTP/1.1[0m" 404 -
2025-04-08 13:15:51,137 - INFO -  * Detected change in 'C:\\Users\\Minh\\Documents\\GitHub\\doan2\\routes\\payment.py', reloading
2025-04-08 13:15:51,253 - INFO -  * Restarting with stat
2025-04-08 13:18:41,580 - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
2025-04-08 13:18:41,580 - INFO - [33mPress CTRL+C to quit[0m
2025-04-08 13:18:41,581 - INFO -  * Restarting with stat
2025-04-08 13:18:42,287 - WARNING -  * Debugger is active!
2025-04-08 13:18:42,293 - INFO -  * Debugger PIN: 716-329-026
2025-04-08 13:18:43,998 - INFO - 127.0.0.1 - - [08/Apr/2025 13:18:43] "GET / HTTP/1.1" 200 -
2025-04-08 13:18:49,464 - INFO - HTTP Request: GET https://uaggzmqpvbtrinppmhrc.supabase.co/rest/v1/phong?select=%2A&trangthai=eq.Tr%E1%BB%91ng "HTTP/2 200 OK"
2025-04-08 13:18:49,471 - INFO - 127.0.0.1 - - [08/Apr/2025 13:18:49] "GET /booking/dat-phong HTTP/1.1" 200 -
2025-04-08 13:19:04,256 - INFO - HTTP Request: GET https://uaggzmqpvbtrinppmhrc.supabase.co/rest/v1/phong?select=%2A&trangthai=eq.Tr%E1%BB%91ng "HTTP/2 200 OK"
2025-04-08 13:19:04,369 - INFO - HTTP Request: POST https://uaggzmqpvbtrinppmhrc.supabase.co/rest/v1/datphong "HTTP/2 201 Created"
2025-04-08 13:19:04,371 - INFO - 127.0.0.1 - - [08/Apr/2025 13:19:04] "[32mPOST /booking/dat-phong HTTP/1.1[0m" 302 -
2025-04-08 13:19:04,564 - INFO - HTTP Request: GET https://uaggzmqpvbtrinppmhrc.supabase.co/rest/v1/datphong?select=tongtien&madatphong=eq.8 "HTTP/2 200 OK"
2025-04-08 13:19:04,569 - INFO - Request[POST]: https://api.sandbox.paypal.com/v1/oauth2/token
2025-04-08 13:19:05,697 - INFO - Response[200]: OK, Duration: 1.127419s.
2025-04-08 13:19:05,698 - INFO - PayPal-Request-Id: 673c176b-0f83-4747-b8e7-e27b80da2130
2025-04-08 13:19:05,698 - INFO - Request[POST]: https://api.sandbox.paypal.com/v1/payments/payment
2025-04-08 13:19:06,740 - INFO - Response[201]: Created, Duration: 1.40623s.
2025-04-08 13:19:06,740 - INFO - T·∫°o payment th√†nh c√¥ng. Booking ID: 8, Payment ID: PAYID-M72L7WQ35131845NH0937443
2025-04-08 13:19:06,740 - INFO - 127.0.0.1 - - [08/Apr/2025 13:19:06] "[32mGET /payment/8 HTTP/1.1[0m" 302 -
2025-04-08 13:19:12,472 - INFO - Request[GET]: https://api.sandbox.paypal.com/v1/payments/payment/PAYID-M72L7WQ35131845NH0937443
2025-04-08 13:19:13,105 - INFO - Response[200]: OK, Duration: 0.631838s.
2025-04-08 13:19:13,105 - INFO - PayPal-Request-Id: cf557be1-856d-47a1-9d8b-1f4c46ca1612
2025-04-08 13:19:13,105 - INFO - Request[POST]: https://api.sandbox.paypal.com/v1/payments/payment/PAYID-M72L7WQ35131845NH0937443/execute
2025-04-08 13:19:14,639 - INFO - Response[400]: Bad Request, Duration: 1.534237s.
2025-04-08 13:19:14,646 - ERROR - Th·ª±c hi·ªán thanh to√°n th·∫•t b·∫°i. L·ªói: {'name': 'INSTRUMENT_DECLINED', 'message': "The instrument presented was either declined by the processor or bank, or it can't be used for this payment.", 'information_link': 'https://developer.paypal.com/docs/api/payments/#errors', 'debug_id': 'bada5bbf47bdd'}
2025-04-08 13:19:14,716 - INFO - 127.0.0.1 - - [08/Apr/2025 13:19:14] "[35m[1mGET /payment/success?paymentId=PAYID-M72L7WQ35131845NH0937443&token=EC-3V885465T8424712U&PayerID=EZEAHEJEKML38 HTTP/1.1[0m" 500 -
2025-04-08 13:19:14,934 - INFO - 127.0.0.1 - - [08/Apr/2025 13:19:14] "GET /payment/success?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1" 200 -
2025-04-08 13:19:14,948 - INFO - 127.0.0.1 - - [08/Apr/2025 13:19:14] "GET /payment/success?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1" 200 -
2025-04-08 13:19:15,301 - INFO - 127.0.0.1 - - [08/Apr/2025 13:19:15] "GET /payment/success?__debugger__=yes&cmd=resource&f=console.png&s=AEOB6gTXmh6pnZ4ujU1g HTTP/1.1" 200 -
2025-04-08 13:19:15,565 - INFO - 127.0.0.1 - - [08/Apr/2025 13:19:15] "GET /payment/success?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1" 200 -
2025-04-08 13:20:05,561 - INFO -  * Detected change in 'C:\\Users\\Minh\\Documents\\GitHub\\doan2\\routes\\payment.py', reloading
2025-04-08 13:20:05,652 - INFO -  * Restarting with stat
2025-04-08 13:20:06,321 - WARNING -  * Debugger is active!
2025-04-08 13:20:06,321 - INFO -  * Debugger PIN: 716-329-026
2025-04-08 13:20:08,286 - INFO - Request[POST]: https://api.sandbox.paypal.com/v1/oauth2/token
2025-04-08 13:20:09,099 - INFO - Response[200]: OK, Duration: 0.812783s.
2025-04-08 13:20:09,099 - INFO - Request[GET]: https://api.sandbox.paypal.com/v1/payments/payment/PAYID-M72L7WQ35131845NH0937443
2025-04-08 13:20:09,749 - INFO - Response[200]: OK, Duration: 0.649969s.
2025-04-08 13:20:09,749 - INFO - PayPal-Request-Id: fc027684-cb9c-4b80-810f-db41a1d74b42
2025-04-08 13:20:09,749 - INFO - Request[POST]: https://api.sandbox.paypal.com/v1/payments/payment/PAYID-M72L7WQ35131845NH0937443/execute
2025-04-08 13:20:11,002 - INFO - Response[400]: Bad Request, Duration: 1.252459s.
2025-04-08 13:20:11,003 - ERROR - Th·ª±c hi·ªán thanh to√°n th·∫•t b·∫°i. L·ªói: {'name': 'INSTRUMENT_DECLINED', 'message': "The instrument presented was either declined by the processor or bank, or it can't be used for this payment.", 'information_link': 'https://developer.paypal.com/docs/api/payments/#errors', 'debug_id': '0eb7bc4788d62'}
2025-04-08 13:20:11,020 - INFO - 127.0.0.1 - - [08/Apr/2025 13:20:11] "[35m[1mGET /payment/success?paymentId=PAYID-M72L7WQ35131845NH0937443&token=EC-3V885465T8424712U&PayerID=EZEAHEJEKML38 HTTP/1.1[0m" 500 -
2025-04-08 13:20:11,139 - INFO - 127.0.0.1 - - [08/Apr/2025 13:20:11] "[36mGET /payment/success?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1[0m" 304 -
2025-04-08 13:20:11,140 - INFO - 127.0.0.1 - - [08/Apr/2025 13:20:11] "[36mGET /payment/success?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1[0m" 304 -
2025-04-08 13:20:11,467 - INFO - 127.0.0.1 - - [08/Apr/2025 13:20:11] "GET /payment/success?__debugger__=yes&cmd=resource&f=console.png&s=ryhQx0qoMzq5TMLRCmut HTTP/1.1" 200 -
2025-04-08 13:20:11,718 - INFO - 127.0.0.1 - - [08/Apr/2025 13:20:11] "[36mGET /payment/success?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1[0m" 304 -
2025-04-08 13:21:02,015 - INFO -  * Detected change in 'C:\\Users\\Minh\\Documents\\GitHub\\doan2\\routes\\payment.py', reloading
2025-04-08 13:21:02,120 - INFO -  * Restarting with stat
2025-04-08 13:21:02,809 - WARNING -  * Debugger is active!
2025-04-08 13:21:02,818 - INFO -  * Debugger PIN: 716-329-026
2025-04-08 13:21:05,021 - INFO -  * Detected change in 'C:\\Users\\Minh\\Documents\\GitHub\\doan2\\routes\\payment.py', reloading
2025-04-08 13:21:05,166 - INFO -  * Restarting with stat
2025-04-08 13:21:05,903 - WARNING -  * Debugger is active!
2025-04-08 13:21:05,918 - INFO -  * Debugger PIN: 716-329-026
2025-04-08 13:21:12,301 - INFO -  * Detected change in 'C:\\Users\\Minh\\Documents\\GitHub\\doan2\\routes\\payment.py', reloading
2025-04-08 13:21:12,412 - INFO -  * Restarting with stat
2025-04-08 13:21:13,027 - WARNING -  * Debugger is active!
2025-04-08 13:21:13,043 - INFO -  * Debugger PIN: 716-329-026
2025-04-08 13:21:20,349 - INFO - Request[POST]: https://api.sandbox.paypal.com/v1/oauth2/token
2025-04-08 13:21:20,943 - INFO - Response[200]: OK, Duration: 0.594160s.
2025-04-08 13:21:20,944 - INFO - Request[GET]: https://api.sandbox.paypal.com/v1/payments/payment/PAYID-M72L7WQ35131845NH0937443
2025-04-08 13:21:21,593 - INFO - Response[200]: OK, Duration: 0.647744s.
2025-04-08 13:21:21,595 - INFO - PayPal-Request-Id: 02c2275b-8aa4-4e40-9b3a-bfd7ee9498f6
2025-04-08 13:21:21,596 - INFO - Request[POST]: https://api.sandbox.paypal.com/v1/payments/payment/PAYID-M72L7WQ35131845NH0937443/execute
2025-04-08 13:21:22,811 - INFO - Response[400]: Bad Request, Duration: 1.215341s.
2025-04-08 13:21:22,813 - ERROR - Th·ª±c hi·ªán thanh to√°n th·∫•t b·∫°i. L·ªói: {'name': 'INSTRUMENT_DECLINED', 'message': "The instrument presented was either declined by the processor or bank, or it can't be used for this payment.", 'information_link': 'https://developer.paypal.com/docs/api/payments/#errors', 'debug_id': '4643ef1907ed5'}
2025-04-08 13:21:22,830 - INFO - 127.0.0.1 - - [08/Apr/2025 13:21:22] "[35m[1mGET /payment/success?paymentId=PAYID-M72L7WQ35131845NH0937443&token=EC-3V885465T8424712U&PayerID=EZEAHEJEKML38 HTTP/1.1[0m" 500 -
2025-04-08 13:21:22,967 - INFO - 127.0.0.1 - - [08/Apr/2025 13:21:22] "[36mGET /payment/success?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1[0m" 304 -
2025-04-08 13:21:22,967 - INFO - 127.0.0.1 - - [08/Apr/2025 13:21:22] "[36mGET /payment/success?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1[0m" 304 -
2025-04-08 13:21:23,293 - INFO - 127.0.0.1 - - [08/Apr/2025 13:21:23] "GET /payment/success?__debugger__=yes&cmd=resource&f=console.png&s=wvUbwZxY4KWdoVe7jkSw HTTP/1.1" 200 -
2025-04-08 13:21:23,542 - INFO - 127.0.0.1 - - [08/Apr/2025 13:21:23] "[36mGET /payment/success?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1[0m" 304 -
2025-04-08 13:22:37,194 - INFO -  * Detected change in 'C:\\Users\\Minh\\Documents\\GitHub\\doan2\\routes\\payment.py', reloading
2025-04-08 13:22:37,314 - INFO -  * Restarting with stat
2025-04-08 13:22:37,956 - WARNING -  * Debugger is active!
2025-04-08 13:22:37,957 - INFO -  * Debugger PIN: 716-329-026
2025-04-08 13:22:41,203 - INFO -  * Detected change in 'C:\\Users\\Minh\\Documents\\GitHub\\doan2\\routes\\payment.py', reloading
2025-04-08 13:22:41,322 - INFO -  * Restarting with stat
2025-04-08 13:22:42,017 - WARNING -  * Debugger is active!
2025-04-08 13:22:42,034 - INFO -  * Debugger PIN: 716-329-026
2025-04-08 13:22:46,233 - INFO -  * Detected change in 'C:\\Users\\Minh\\Documents\\GitHub\\doan2\\routes\\payment.py', reloading
2025-04-08 13:22:46,355 - INFO -  * Restarting with stat
2025-04-08 13:22:47,064 - WARNING -  * Debugger is active!
2025-04-08 13:22:47,064 - INFO -  * Debugger PIN: 716-329-026
2025-04-08 13:22:47,861 - INFO - Request[POST]: https://api.sandbox.paypal.com/v1/oauth2/token
2025-04-08 13:22:48,838 - INFO - Response[200]: OK, Duration: 0.975613s.
2025-04-08 13:22:48,839 - INFO - Request[GET]: https://api.sandbox.paypal.com/v1/payments/payment/PAYID-M72L7WQ35131845NH0937443
2025-04-08 13:22:49,860 - INFO - Response[200]: OK, Duration: 1.19534s.
2025-04-08 13:22:49,862 - INFO - PayPal-Request-Id: 7860c58f-6e44-4583-9aff-b4b4770f0f92
2025-04-08 13:22:49,862 - INFO - Request[POST]: https://api.sandbox.paypal.com/v1/payments/payment/PAYID-M72L7WQ35131845NH0937443/execute
2025-04-08 13:22:51,411 - INFO - Response[400]: Bad Request, Duration: 1.548293s.
2025-04-08 13:22:51,412 - ERROR - Th·ª±c hi·ªán thanh to√°n th·∫•t b·∫°i. L·ªói: {'name': 'INSTRUMENT_DECLINED', 'message': "The instrument presented was either declined by the processor or bank, or it can't be used for this payment.", 'information_link': 'https://developer.paypal.com/docs/api/payments/#errors', 'debug_id': '64a803408a6bb'}
2025-04-08 13:22:51,412 - INFO - 127.0.0.1 - - [08/Apr/2025 13:22:51] "[32mGET /payment/success?paymentId=PAYID-M72L7WQ35131845NH0937443&token=EC-3V885465T8424712U&PayerID=EZEAHEJEKML38 HTTP/1.1[0m" 302 -
2025-04-08 13:22:51,428 - INFO - 127.0.0.1 - - [08/Apr/2025 13:22:51] "GET / HTTP/1.1" 200 -
2025-04-08 13:22:55,549 - INFO - 127.0.0.1 - - [08/Apr/2025 13:22:55] "GET /auth/login HTTP/1.1" 200 -
2025-04-08 13:22:55,847 - INFO - 127.0.0.1 - - [08/Apr/2025 13:22:55] "[33mGET /static/css/style.css HTTP/1.1[0m" 404 -
2025-04-08 13:23:03,297 - INFO - HTTP Request: GET https://uaggzmqpvbtrinppmhrc.supabase.co/rest/v1/khachhang?select=%2A&email=eq.minh1%40gmail.com "HTTP/2 200 OK"
2025-04-08 13:23:03,303 - INFO - 127.0.0.1 - - [08/Apr/2025 13:23:03] "[32mPOST /auth/login HTTP/1.1[0m" 302 -
2025-04-08 13:23:03,312 - INFO - 127.0.0.1 - - [08/Apr/2025 13:23:03] "GET / HTTP/1.1" 200 -
2025-04-08 13:23:04,792 - INFO - HTTP Request: GET https://uaggzmqpvbtrinppmhrc.supabase.co/rest/v1/phong?select=%2A&trangthai=eq.Tr%E1%BB%91ng "HTTP/2 200 OK"
2025-04-08 13:23:04,809 - INFO - 127.0.0.1 - - [08/Apr/2025 13:23:04] "GET /booking/dat-phong HTTP/1.1" 200 -
2025-04-08 13:23:17,771 - INFO - HTTP Request: GET https://uaggzmqpvbtrinppmhrc.supabase.co/rest/v1/phong?select=%2A&trangthai=eq.Tr%E1%BB%91ng "HTTP/2 200 OK"
2025-04-08 13:23:17,869 - INFO - HTTP Request: POST https://uaggzmqpvbtrinppmhrc.supabase.co/rest/v1/datphong "HTTP/2 201 Created"
2025-04-08 13:23:17,869 - INFO - 127.0.0.1 - - [08/Apr/2025 13:23:17] "[32mPOST /booking/dat-phong HTTP/1.1[0m" 302 -
2025-04-08 13:23:18,049 - INFO - HTTP Request: GET https://uaggzmqpvbtrinppmhrc.supabase.co/rest/v1/datphong?select=tongtien&madatphong=eq.9 "HTTP/2 200 OK"
2025-04-08 13:23:18,056 - INFO - PayPal-Request-Id: 60baef81-94bf-4aaf-b7e2-220e27a47adb
2025-04-08 13:23:18,056 - INFO - Request[POST]: https://api.sandbox.paypal.com/v1/payments/payment
2025-04-08 13:23:19,355 - INFO - Response[201]: Created, Duration: 1.297430s.
2025-04-08 13:23:19,355 - INFO - T·∫°o payment th√†nh c√¥ng. Booking ID: 9, Payment ID: PAYID-M72MBVQ4MK84949CB353804E
2025-04-08 13:23:19,355 - INFO - 127.0.0.1 - - [08/Apr/2025 13:23:19] "[32mGET /payment/9 HTTP/1.1[0m" 302 -
2025-04-08 13:23:25,152 - INFO - Request[GET]: https://api.sandbox.paypal.com/v1/payments/payment/PAYID-M72MBVQ4MK84949CB353804E
2025-04-08 13:23:26,102 - INFO - Response[200]: OK, Duration: 0.950642s.
2025-04-08 13:23:26,102 - INFO - PayPal-Request-Id: b36e4124-f65a-493d-9460-8c086be6cbcd
2025-04-08 13:23:26,102 - INFO - Request[POST]: https://api.sandbox.paypal.com/v1/payments/payment/PAYID-M72MBVQ4MK84949CB353804E/execute
2025-04-08 13:23:27,710 - INFO - Response[400]: Bad Request, Duration: 1.607548s.
2025-04-08 13:23:27,711 - ERROR - Th·ª±c hi·ªán thanh to√°n th·∫•t b·∫°i. L·ªói: {'name': 'INSTRUMENT_DECLINED', 'message': "The instrument presented was either declined by the processor or bank, or it can't be used for this payment.", 'information_link': 'https://developer.paypal.com/docs/api/payments/#errors', 'debug_id': '157ed8359ff09'}
2025-04-08 13:23:27,712 - INFO - 127.0.0.1 - - [08/Apr/2025 13:23:27] "[32mGET /payment/success?paymentId=PAYID-M72MBVQ4MK84949CB353804E&token=EC-4J712803HV6712455&PayerID=EZEAHEJEKML38 HTTP/1.1[0m" 302 -
2025-04-08 13:23:27,723 - INFO - 127.0.0.1 - - [08/Apr/2025 13:23:27] "GET / HTTP/1.1" 200 -
2025-04-08 13:24:18,271 - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
2025-04-08 13:24:18,271 - INFO - [33mPress CTRL+C to quit[0m
2025-04-08 13:24:18,272 - INFO -  * Restarting with stat
2025-04-08 13:24:18,909 - WARNING -  * Debugger is active!
2025-04-08 13:24:18,915 - INFO -  * Debugger PIN: 716-329-026
2025-04-08 13:24:21,059 - INFO - 127.0.0.1 - - [08/Apr/2025 13:24:21] "GET / HTTP/1.1" 200 -
2025-04-08 13:24:24,434 - INFO - HTTP Request: GET https://uaggzmqpvbtrinppmhrc.supabase.co/rest/v1/phong?select=%2A&trangthai=eq.Tr%E1%BB%91ng "HTTP/2 200 OK"
2025-04-08 13:24:24,447 - INFO - 127.0.0.1 - - [08/Apr/2025 13:24:24] "GET /booking/dat-phong HTTP/1.1" 200 -
2025-04-08 13:24:37,348 - INFO - HTTP Request: GET https://uaggzmqpvbtrinppmhrc.supabase.co/rest/v1/phong?select=%2A&trangthai=eq.Tr%E1%BB%91ng "HTTP/2 200 OK"
2025-04-08 13:24:37,509 - INFO - HTTP Request: POST https://uaggzmqpvbtrinppmhrc.supabase.co/rest/v1/datphong "HTTP/2 201 Created"
2025-04-08 13:24:37,509 - INFO - 127.0.0.1 - - [08/Apr/2025 13:24:37] "[32mPOST /booking/dat-phong HTTP/1.1[0m" 302 -
2025-04-08 13:24:37,681 - INFO - HTTP Request: GET https://uaggzmqpvbtrinppmhrc.supabase.co/rest/v1/datphong?select=tongtien&madatphong=eq.10 "HTTP/2 200 OK"
2025-04-08 13:24:37,688 - INFO - Request[POST]: https://api.sandbox.paypal.com/v1/oauth2/token
2025-04-08 13:24:38,275 - INFO - Response[200]: OK, Duration: 0.586082s.
2025-04-08 13:24:38,276 - INFO - PayPal-Request-Id: 407018ae-044a-45c8-8527-1c2548ce286b
2025-04-08 13:24:38,276 - INFO - Request[POST]: https://api.sandbox.paypal.com/v1/payments/payment
2025-04-08 13:24:39,326 - INFO - Response[201]: Created, Duration: 1.50694s.
2025-04-08 13:24:39,326 - INFO - T·∫°o payment th√†nh c√¥ng. Booking ID: 10, Payment ID: PAYID-M72MCJQ577158481E0467539
2025-04-08 13:24:39,326 - INFO - 127.0.0.1 - - [08/Apr/2025 13:24:39] "[32mGET /payment/10 HTTP/1.1[0m" 302 -
2025-04-08 13:24:45,743 - INFO - Request[GET]: https://api.sandbox.paypal.com/v1/payments/payment/PAYID-M72MCJQ577158481E0467539
2025-04-08 13:24:46,607 - INFO - Response[200]: OK, Duration: 0.858929s.
2025-04-08 13:24:46,607 - INFO - PayPal-Request-Id: 0dff14a2-d5b6-4c28-9026-a18be2569297
2025-04-08 13:24:46,607 - INFO - Request[POST]: https://api.sandbox.paypal.com/v1/payments/payment/PAYID-M72MCJQ577158481E0467539/execute
2025-04-08 13:24:47,875 - INFO - Response[200]: OK, Duration: 1.267685s.
2025-04-08 13:24:47,891 - INFO - Thanh to√°n th√†nh c√¥ng. Payment ID: PAYID-M72MCJQ577158481E0467539, Transaction ID: 5MS77097X70518230, Booking ID: 10
2025-04-08 13:24:48,473 - INFO - HTTP Request: PATCH https://uaggzmqpvbtrinppmhrc.supabase.co/rest/v1/hoadon?mahoadon=eq.10 "HTTP/2 200 OK"
2025-04-08 13:24:48,491 - INFO - 127.0.0.1 - - [08/Apr/2025 13:24:48] "[32mGET /payment/success?paymentId=PAYID-M72MCJQ577158481E0467539&token=EC-7WK30915LE177064N&PayerID=EZEAHEJEKML38 HTTP/1.1[0m" 302 -
2025-04-08 13:24:48,498 - INFO - 127.0.0.1 - - [08/Apr/2025 13:24:48] "GET / HTTP/1.1" 200 -
